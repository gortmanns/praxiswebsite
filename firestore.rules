/**
 * @fileoverview Firestore Security Rules for Praxis Online application.
 *
 * Core Philosophy:
 * This ruleset provides basic security for doctor profiles, contact form submissions, and symptom checks.
 * All write operations are restricted.
 *
 * Data Structure:
 * The database consists of three top-level collections:
 * - /doctor_profiles/{doctorProfileId}
 * - /contact_form_submissions/{contactFormSubmissionId}
 * - /symptom_checks/{symptomCheckId}
 *
 * Key Security Decisions:
 * - Doctor profiles are publicly readable, but write access is restricted.
 * - Contact form submissions are only writable.
 * - Symptom checks are publicly readable, but write access is restricted.
 * - No user listing is allowed on any collections.
 */
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    /**
     * @description Manages access to doctor profiles. Doctors' profiles are publicly available for reading. Writing is not allowed.
     * @path /doctor_profiles/{doctorProfileId}
     * @allow (get, list) Any user can read doctor profiles.
     * @deny (create, update, delete) No user can create, update, or delete doctor profiles.
     * @principle Allows public read access while restricting write access.
     */
    match /doctor_profiles/{doctorProfileId} {
      allow get, list: if true;
      allow create: if false;
      allow update: if false;
      allow delete: if false;
    }

    /**
     * @description Manages access to contact form submissions. All users can submit.
     * @path /contact_form_submissions/{contactFormSubmissionId}
     * @allow (create) Any user can create contact form submissions.
     * @deny (get, list, update, delete) No user can get, list, update, or delete contact form submissions.
     * @principle Allows public submissions while restricting read, update, and delete access.
     */
    match /contact_form_submissions/{contactFormSubmissionId} {
      allow get, list: if false;
      allow create: if true;
      allow update: if false;
      allow delete: if false;
    }

    /**
     * @description Manages access to symptom checks. Symptom checks are publicly readable. Writing is not allowed.
     * @path /symptom_checks/{symptomCheckId}
     * @allow (get, list) Any user can read symptom checks.
     * @deny (create, update, delete) No user can create, update, or delete symptom checks.
     * @principle Allows public read access while restricting write access.
     */
    match /symptom_checks/{symptomCheckId} {
      allow get, list: if true;
      allow create: if false;
      allow update: if false;
      allow delete: if false;
    }
    /**
     * @description Allows creating/writing to a test collection.
     * @path /tests/{testId}
     * @allow (create) Any user can create test documents.
     * @deny (get, list, update, delete) No user can get, list, update, or delete test documents.
     * @principle Allows temporary write access to test the database connection.
     */
    match /tests/{testId} {
      allow get, list: if false;
      allow create: if true;
      allow update: if false;
      allow delete: if false;
    }
  }
}