/**
 * @file Firestore Security Rules for Praxis Online
 * @core_philosophy This ruleset provides a baseline security posture for the Praxis Online application,
 * enforcing a separation of concerns between doctor profiles, contact form submissions, and symptom checks.
 * It emphasizes straightforward, collection-level access control without complex relational checks in the rules.
 * @data_structure Data is stored in three top-level collections: `doctor_profiles`, `contact_form_submissions`,
 * and `symptom_checks`. Each collection is treated independently for security purposes.
 * @key_security_decisions
 *  - Doctor profiles are publicly readable.
 *  - Writes to `contact_form_submissions` are disallowed for non-authenticated users.
 *  - Symptom checks are publicly readable.
 * @denormalization No denormalization is used in this version.
 */
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    /**
     * @description Allows public read access to doctor profiles, but restricts write access.
     * @path /doctor_profiles/{doctorProfileId}
     * @allow (get, list) Allow anyone to read doctor profiles.
     * @allow (create, update, delete) Deny non-authenticated users from writing doctor profiles.
     * @deny (create) Deny doctor creation.
     * @deny (update) Deny doctor update.
     * @deny (delete) Deny doctor deletion.
     * @principle Allows public read access but restricts write access.
     */
    match /doctor_profiles/{doctorProfileId} {
      allow get, list: if true;
      allow create, update, delete: if false;
    }

    /**
     * @description Restricts write access to contact form submissions.
     * @path /contact_form_submissions/{contactFormSubmissionId}
     * @allow (get, list) Allows anyone to read contact_form_submissions.
     * @deny (create) Denies contact_form_submissions creation.
     * @deny (update) Denies contact_form_submissions update.
     * @deny (delete) Denies contact_form_submissions deletion.
     * @principle Prevents unauthenticated users from creating or modifying contact form submissions.
     */
    match /contact_form_submissions/{contactFormSubmissionId} {
      allow get, list: if true;
      allow create, update, delete: if false;
    }

    /**
     * @description Allows public read access to symptom checks, but restricts write access.
     * @path /symptom_checks/{symptomCheckId}
     * @allow (get, list) Allow anyone to read symptom checks.
     * @allow (create, update, delete) Deny non-authenticated users from writing symptom checks.
     * @deny (create) Deny symptom creation.
     * @deny (update) Deny symptom update.
     * @deny (delete) Deny symptom deletion.
     * @principle Allows public read access but restricts write access.
     */
    match /symptom_checks/{symptomCheckId} {
      allow get, list: if true;
      allow create, update, delete: if false;
    }
  }
}