/**
 * @fileoverview Firestore Security Rules for Praxis Online.
 *
 * Core Philosophy:
 * This ruleset prioritizes security by enforcing strict separation of concerns and explicit access controls.
 * Doctor profiles are publicly readable, while contact form submissions and symptom checks are restricted to prevent unauthorized modification.
 *
 * Data Structure:
 * The database consists of three top-level collections:
 * - /doctor_profiles/{doctorProfileId}: Stores information about doctors.
 * - /contact_form_submissions/{contactFormSubmissionId}: Stores contact form submissions.
 * - /symptom_checks/{symptomCheckId}: Stores symptom check records.
 *
 * Key Security Decisions:
 * - Doctor profiles are publicly readable to allow easy access to doctor information. Write access is restricted.
 * - Contact form submissions are restricted to read access to prevent unauthorized data manipulation.
 * - Symptom checks have open access.
 * - No user listing is permitted on any collection.
 *
 * Denormalization for Authorization:
 *  N/A. All collections are top-level and do not require complex authorization logic based on parent documents.
 */
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    /**
     * @description Allows anyone to read doctor profiles, but restricts creation, updates, and deletion.
     * @path /doctor_profiles/{doctorProfileId}
     * @allow get, list: Anyone can read doctor profiles.
     * @deny create, update, delete: No one can create, update, or delete doctor profiles through client-side rules.
     * @principle Public read, restricted write.
     */
    match /doctor_profiles/{doctorProfileId} {
      allow get: if true;
      allow list: if true;
      allow create: if false;
      allow update: if false;
      allow delete: if false;
    }

    /**
     * @description Restricts all access to contact form submissions to prevent unauthorized data handling.
     * @path /contact_form_submissions/{contactFormSubmissionId}
     * @allow get, list: if false;
     * @deny create, update, delete: No one can create, update, or delete contact form submissions through client-side rules.
     * @principle No client access to submissions.
     */
    match /contact_form_submissions/{contactFormSubmissionId} {
      allow get: if false;
      allow list: if false;
      allow create: if false;
      allow update: if false;
      allow delete: if false;
    }

    /**
     * @description Allows anyone to read doctor profiles, but restricts creation, updates, and deletion.
     * @path /symptom_checks/{symptomCheckId}
     * @allow get, list: Anyone can read symptom checks.
     * @deny create, update, delete: No one can create, update, or delete symptom checks through client-side rules.
     * @principle Public read, restricted write.
     */
    match /symptom_checks/{symptomCheckId} {
      allow get: if true;
      allow list: if true;
      allow create: if false;
      allow update: if false;
      allow delete: if false;
    }
  }
}