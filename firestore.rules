rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    function isSignedIn() {
      return request.auth != null;
    }

    function isOwner(resourceAuthorId) {
      return isSignedIn() && request.auth.uid == resourceAuthorId;
    }

    function isExistingOwner(resourceAuthorId) {
      return isSignedIn() && resource.data.id == request.auth.uid;
    }

    /**
     * @description Allows public read access and owner-only write access for doctor profiles.
     * @path /doctors/{doctorId}
     */
    match /doctors/{doctorId} {
      allow get, list: if true;
      allow create: if isSignedIn() && request.resource.data.id == request.auth.uid;
      allow update: if isSignedIn() && request.resource.data.id == resource.data.id;
      allow delete: if isSignedIn() && resource.data.id == resource.data.id;
    }

    /**
     * @description Allows public read access and owner-only write access for staff member profiles.
     * @path /staff/{staffId}
     */
    match /staff/{staffId} {
      allow get, list: if true;
      allow create: if isSignedIn() && request.resource.data.id == request.auth.uid;
      allow update: if isSignedIn() && request.resource.data.id == resource.data.id;
      allow delete: if isSignedIn() && resource.data.id == resource.data.id;
    }

    /**
     * @description Allows public read access and owner-only write access for medical partner information.
     * @path /medicalPartners/{partnerId}
     */
    match /medicalPartners/{partnerId} {
      allow get, list: if true;
      allow create: if isSignedIn() && request.resource.data.id == request.auth.uid;
      allow update: if isSignedIn() && request.resource.data.id == resource.data.id;
      allow delete: if isSignedIn() && resource.data.id == resource.data.id;
    }

    /**
     * @description Allows public read access and owner-only write access for other partner information.
     * @path /otherPartners/{partnerId}
     */
    match /otherPartners/{partnerId} {
      allow get, list: if true;
      allow create: if isSignedIn() && request.resource.data.id == request.auth.uid;
      allow update: if isSignedIn() && request.resource.data.id == resource.data.id;
      allow delete: if isSignedIn() && resource.data.id == resource.data.id;
    }

        /**
         * @description Allows public read access and owner-only write access for holiday periods.
         * @path /holidays/{holidayId}
         */
    match /holidays/{holidayId} {
      allow get, list: if true;
      allow create: if isSignedIn() && request.resource.data.id == request.auth.uid;
      allow update: if isSignedIn() && request.resource.data.id == resource.data.id;
      allow delete: if isSignedIn() && resource.data.id == resource.data.id;
    }

    /**
     * @description Allows public read access and owner-only write access for info banners.
     * @path /infoBanners/{bannerId}
     */
    match /infoBanners/{bannerId} {
      allow get, list: if true;
      allow create: if isSignedIn() && request.resource.data.id == request.auth.uid;
      allow update: if isSignedIn() && request.resource.data.id == resource.data.id;
      allow delete: if isSignedIn() && resource.data.id == resource.data.id;
    }

    /**
     * @description Allows public read access and owner-only write access for banner settings.
     * @path /settings/banners
     */
    match /settings/banners {
      allow get: if true;
      allow create: if isSignedIn() && request.resource.data.id == request.auth.uid;
      allow update: if isSignedIn() && request.resource.data.id == resource.data.id;
      allow delete: if isSignedIn() && request.resource.data.id == resource.data.id;
    }
  }
}