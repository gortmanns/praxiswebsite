/**
 * @fileoverview Firestore Security Rules for the practice app.
 *
 * Core Philosophy:
 * This ruleset provides public read access to all collections, but restricts write access to authenticated users only.
 * This allows for easy data consumption while ensuring that only authorized users can modify the data.
 *
 * Data Structure:
 * The Firestore database consists of several top-level collections: 'doctors', 'staff', 'medicalPartners',
 * 'otherPartners', 'holidays', 'infoBanners', and a single document at 'settings/banners'. Each collection
 * contains documents representing entities like doctors, staff members, partners, holidays, and info banners.
 * The 'settings/banners' document contains configuration settings for holiday banners.
 *
 * Key Security Decisions:
 * - Public read access is granted to all collections to facilitate easy data consumption.
 * - Write access (create, update, delete) is restricted to authenticated users.
 * - No schema validation is performed in this prototyping phase to allow for rapid iteration.
 */
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    /**
     * @description Allows public read access to doctor profiles. Restricts write access to authenticated users.
     * @path /doctors/{doctorId}
     * @allow (get, list): Any user can read doctor profiles.
     * @allow (create, update, delete): Only authenticated users can modify doctor profiles.
     * @deny (create, update, delete): Unauthenticated users cannot modify doctor profiles.
     * @principle Allows public reads, restricts writes to authenticated users.
     */
    match /doctors/{doctorId} {
      allow get, list: if true;
      allow create, update, delete: if isSignedIn();
    }

    /**
     * @description Allows public read access to staff member profiles. Restricts write access to authenticated users.
     * @path /staff/{staffMemberId}
     * @allow (get, list): Any user can read staff member profiles.
     * @allow (create, update, delete): Only authenticated users can modify staff member profiles.
     * @deny (create, update, delete): Unauthenticated users cannot modify staff member profiles.
     * @principle Allows public reads, restricts writes to authenticated users.
     */
    match /staff/{staffMemberId} {
      allow get, list: if true;
      allow create, update, delete: if isSignedIn();
    }

    /**
     * @description Allows public read access to medical partner information. Restricts write access to authenticated users.
     * @path /medicalPartners/{medicalPartnerId}
     * @allow (get, list): Any user can read medical partner information.
     * @allow (create, update, delete): Only authenticated users can modify medical partner information.
     * @deny (create, update, delete): Unauthenticated users cannot modify medical partner information.
     * @principle Allows public reads, restricts writes to authenticated users.
     */
    match /medicalPartners/{medicalPartnerId} {
      allow get, list: if true;
      allow create, update, delete: if isSignedIn();
    }

    /**
     * @description Allows public read access to other partner information. Restricts write access to authenticated users.
     * @path /otherPartners/{otherPartnerId}
     * @allow (get, list): Any user can read other partner information.
     * @allow (create, update, delete): Only authenticated users can modify other partner information.
     * @deny (create, update, delete): Unauthenticated users cannot modify other partner information.
     * @principle Allows public reads, restricts writes to authenticated users.
     */
    match /otherPartners/{otherPartnerId} {
      allow get, list: if true;
      allow create, update, delete: if isSignedIn();
    }

    /**
     * @description Allows public read access to holiday information. Restricts write access to authenticated users.
     * @path /holidays/{holidayId}
     * @allow (get, list): Any user can read holiday information.
     * @allow (create, update, delete): Only authenticated users can modify holiday information.
     * @deny (create, update, delete): Unauthenticated users cannot modify holiday information.
     * @principle Allows public reads, restricts writes to authenticated users.
     */
    match /holidays/{holidayId} {
      allow get, list: if true;
      allow create, update, delete: if isSignedIn();
    }

    /**
     * @description Allows public read access to info banner information. Restricts write access to authenticated users.
     * @path /infoBanners/{infoBannerId}
     * @allow (get, list): Any user can read info banner information.
     * @allow (create, update, delete): Only authenticated users can modify info banner information.
     * @deny (create, update, delete): Unauthenticated users cannot modify info banner information.
     * @principle Allows public reads, restricts writes to authenticated users.
     */
    match /infoBanners/{infoBannerId} {
      allow get, list: if true;
      allow create, update, delete: if isSignedIn();
    }

    /**
     * @description Allows public read access to banner settings. Restricts write access to authenticated users.
     * @path /settings/banners
     * @allow (get): Any user can read banner settings.
     * @allow (create, update, delete): Only authenticated users can modify banner settings.
     * @deny (create, update, delete): Unauthenticated users cannot modify banner settings.
     * @principle Allows public reads, restricts writes to authenticated users.
     */
    match /settings/banners {
      allow get: if true;
      allow create, update, delete: if isSignedIn();
    }

    /**
     * @description Helper function to determine if a user is signed in.
     */
    function isSignedIn() {
      return request.auth != null;
    }
  }
}