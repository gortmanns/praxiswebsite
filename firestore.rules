/**
 * @fileoverview Firestore Security Rules for the practice data model.
 *
 * Core Philosophy:
 * This ruleset is designed for the prototyping phase and prioritizes security by default,
 * restricting all access unless explicitly allowed. It assumes an administrative backend
 * will manage the data, so it generally denies direct client writes. Read access is generally
 * public to facilitate data consumption, but can be restricted on a per-collection basis.
 *
 * Data Structure:
 * The Firestore database contains several top-level collections: `doctors`, `staff`,
 * `medicalPartners`, `otherPartners`, and `holidays`.  A single document at `settings/banners`
 * stores global banner settings.
 *
 * Key Security Decisions:
 * - No user listing is allowed to prevent information disclosure.
 * - All write access is denied by default, assuming an administrative backend.
 * - Read access is public by default for most collections to facilitate rapid prototyping,
 *   but this can be overridden as needed.
 */
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    /**
     * @description Controls access to the 'doctors' collection.
     * @path /doctors/{doctorId}
     * @allow get, list: Any user can read doctor profiles.
     * @allow create, update, delete: No direct client writes allowed.
     * @deny create, update, delete: All clients are denied from creating, updating, or deleting doctors.
     * @principle Public read access, admin-only writes.
     */
    match /doctors/{doctorId} {
      allow get, list: if true;
      allow create, update, delete: if false;
    }

    /**
     * @description Controls access to the 'staff' collection.
     * @path /staff/{staffId}
     * @allow get, list: Any user can read staff profiles.
     * @allow create, update, delete: No direct client writes allowed.
     * @deny create, update, delete: All clients are denied from creating, updating, or deleting staff members.
     * @principle Public read access, admin-only writes.
     */
    match /staff/{staffId} {
      allow get, list: if true;
      allow create, update, delete: if false;
    }

    /**
     * @description Controls access to the 'medicalPartners' collection.
     * @path /medicalPartners/{medicalPartnerId}
     * @allow get, list: Any user can read medical partner profiles.
     * @allow create, update, delete: No direct client writes allowed.
     * @deny create, update, delete: All clients are denied from creating, updating, or deleting medical partners.
     * @principle Public read access, admin-only writes.
     */
    match /medicalPartners/{medicalPartnerId} {
      allow get, list: if true;
      allow create, update, delete: if false;
    }

    /**
     * @description Controls access to the 'otherPartners' collection.
     * @path /otherPartners/{otherPartnerId}
     * @allow get, list: Any user can read other partner profiles.
     * @allow create, update, delete: No direct client writes allowed.
     * @deny create, update, delete: All clients are denied from creating, updating, or deleting other partners.
     * @principle Public read access, admin-only writes.
     */
    match /otherPartners/{otherPartnerId} {
      allow get, list: if true;
      allow create, update, delete: if false;
    }

    /**
     * @description Controls access to the 'holidays' collection.
     * @path /holidays/{holidayId}
     * @allow get, list: Any user can read holiday information.
     * @allow create, update, delete: No direct client writes allowed.
     * @deny create, update, delete: All clients are denied from creating, updating, or deleting holidays.
     * @principle Public read access, admin-only writes.
     */
    match /holidays/{holidayId} {
        allow get, list: if true;
        allow create, update, delete: if false;
    }

    /**
     * @description Controls access to the 'banners' document within the 'settings' collection.
     * @path /settings/banners
     * @allow get: Any user can read the banner settings.
     * @allow create, update, delete: No direct client writes allowed.
     * @deny create, update, delete: All clients are denied from creating, updating, or deleting banner settings.
     * @principle Public read access, admin-only writes.
     */
    match /settings/banners {
        allow get: if true;
        allow create, update, delete: if false;
    }
  }
}